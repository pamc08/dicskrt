<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Dicionário Conciso Sânscrito ↔ Português</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Inter', sans-serif;
      margin: 0;
      background-color: #f9f9f9;
      color: #333;
    }

    header {
      background: #3498db;
      padding: 1em;
      text-align: center;
    }

    nav a {
      color: white;
      margin: 0 1em;
      text-decoration: none;
      font-weight: bold;
      font-size: 1.1em;
      cursor: pointer;
    }

    nav a:hover {
      text-decoration: underline;
    }

    .container {
      max-width: 900px;
      margin: 2em auto;
      padding: 0 1em;
    }

    h1, h2 {
      text-align: center;
      color: #2c3e50;
      margin-bottom: 1em;
    }

    #searchInput {
      width: 100%;
      padding: 12px;
      font-size: 16px;
      border: 1px solid #ccc;
      border-radius: 6px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
      margin-bottom: 1em;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      background: white;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
      cursor: pointer;
    }

    th, td {
      text-align: left;
      padding: 12px 16px;
    }

    th {
      background-color: #3498db;
      color: white;
      font-weight: 600;
    }

    tr:nth-child(even) {
      background-color: #f2f2f2;
    }

    tr:hover {
      background-color: #eaf6ff;
    }

    section {
      display: none;
    }

    section.active {
      display: block;
    }

    footer {
      margin-top: 2em;
      padding: 1.5em;
      background: #f0f0f0;
      text-align: center;
      font-size: 1.05em;
      color: #555;
    }

    footer img {
      height: 70px;
    }

    @media (max-width: 600px) {
      th, td {
        font-size: 14px;
        padding: 10px;
      }
    }
  </style>
</head>
<body>
  <header>
    <nav>
      <a data-section="inicio">Início</a>
      <a data-section="sobre">Sobre</a>
      <a data-section="contactos">Contactos</a>
    </nav>
  </header>

  <div class="container">
    <!-- Secção Início -->
    <section id="inicio" class="active">
      <h1>Dicionário Conciso Sânscrito ↔ Português</h1>
      <input type="text" id="searchInput" placeholder="Digite uma palavra em sânscrito ou português..." />
      <table id="dictionaryTable">
        <thead>
          <tr id="headerRow">
            <th>Devanágari</th>
            <th>Romano (transliteração)</th>
            <th>Género (SKRT)</th>
            <th>Tradução em Português</th>
          </tr>
        </thead>
        <tbody>
          <!-- Resultados -->
        </tbody>
      </table>
    </section>

    <!-- Secção Sobre -->
    <section id="sobre">
      <h2>Sobre o Dicionário</h2>
      <p>
        O <strong>Dicionário Conciso Português ↔ Sânscrito</strong> foi criado para auxiliar no estudo e compreensão 
        da língua sânscrita, oferecendo correspondências diretas com o português. Contém entradas em devanágari, 
        transliteração romana e tradução. O objetivo é servir de recurso a investigadores, estudantes e público em geral 
        interessado em linguística e estudos clássicos.
      </p>
    </section>
  
    <!-- Secção Contactos
    <section id="contactos" style="margin-top: 2em; text-align: center;">
      <h2>Contactos</h2>
  
      <p><strong>Paulo Meira</strong></p>
  
      <p><strong>Centro de Estudos Clássicos da Faculdade de Letras da Universidade de Lisboa.</strong></p>
    
  <p>
      <strong>Email:</strong> 
      <a href="mailto:pmeira@letras.ulisboa.pt">pmeira@letras.ulisboa.pt</a>
  </p>
</section>
-->
  </div>

  <footer>
    <p>
      Investigador:
      <a href="mailto:pmeira@letras.ulisboa.pt" style="color: #3498db; text-decoration: none; font-weight: bold;">
        Paulo Meira,
      </a> Centro de Estudos Clássicos da Faculdade de Letras da Universidade de Lisboa.
    </p>
    <p style="font-size: 1.1em; margin-bottom: 0.8em;"><strong>Apoios institucionais:</strong></p>
    <div style="display: flex; justify-content: center; gap: 2em; flex-wrap: wrap; align-items: center;">
      <img src="imagens/FLUL_HORIZONTAL_Cores.jpg" alt="Logo 1" />
      <img src="imagens/Logo_Vertical_2@3x.jpg" alt="Logo 2" />
      <img src="imagens/logo_cei.png" alt="Logo 3" />
      <img src="imagens/2022_FCT_Logo_A_horizontal_preto.jpg" alt="Logo 4" />
    </div>
  </footer>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script>
    let entries = [];

    function normalizarTexto(texto) {
      return (texto || "")
        .normalize("NFD")
        .replace(/[\u0300-\u036f]/g, "")
        .replace(/[ṃṁ]/g, "m")
        .replace(/ṅ/g, "n")
        .replace(/ñ/g, "n")
        .replace(/ṭ/g, "t")
        .replace(/ḍ/g, "d")
        .replace(/ṇ/g, "n")
        .replace(/ś/g, "s")
        .replace(/ṣ/g, "s")
        .replace(/ṛ/g, "r")
        .replace(/ṝ/g, "r")
        .replace(/ḷ/g, "l")
        .replace(/ḹ/g, "l")
        .toLowerCase();
    }

    async function carregarDicionario() {
      try {
        const response = await fetch('dic_skrt_pt.xlsx');
        if (!response.ok) throw new Error("Ficheiro não encontrado!");
        const data = await response.arrayBuffer();
        const workbook = XLSX.read(data, { type: 'array' });
        const sheetName = workbook.SheetNames[0];
        const sheet = workbook.Sheets[sheetName];
        entries = XLSX.utils.sheet_to_json(sheet);
      } catch (err) {
        console.error("Erro ao carregar o dicionário:", err);
      }
    }

    function atualizarCabecalho(pesquisaEmPortugues) {
      const headerRow = document.getElementById('headerRow');
      if (pesquisaEmPortugues) {
        headerRow.innerHTML = `
          <th>Português</th>
          <th>Género (PT)</th>
          <th>Romano (transliteração)</th>
          <th>Devanágari</th>
        `;
      } else {
        headerRow.innerHTML = `
          <th>Devanágari</th>
          <th>Romano (transliteração)</th>
          <th>Género (SKRT)</th>
          <th>Tradução em Português</th>
        `;
      }
    }

    function displayTable(data, pesquisaEmPortugues = false) {
      const tbody = document.querySelector('#dictionaryTable tbody');
      tbody.innerHTML = '';
      atualizarCabecalho(pesquisaEmPortugues);

      if (data.length === 0) return;

      data.forEach(row => {
        const tr = document.createElement('tr');

        if (pesquisaEmPortugues) {
          tr.innerHTML = `
            <td><b>${row['Tradução em PT'] || ''}</b></td>
            <td>${row['Género (PT)'] || ''}</td>
            <td>${row['Romano translit'] || ''}</td>
            <td>${row['Devan.'] || ''}</td>
          `;
        } else {
          tr.innerHTML = `
            <td>${row['Devan.'] || ''}</td>
            <td>${row['Romano translit'] || ''}</td>
            <td>${row['Género (SKRT)'] || ''}</td>
            <td><b>${row['Tradução em PT'] || ''}</b></td>
          `;
        }

        tr.addEventListener('click', () => {
          document.getElementById('searchInput').value = pesquisaEmPortugues 
            ? row['Tradução em PT'] 
            : row['Romano translit'] || row['Devan.'];
          displayTable([row], pesquisaEmPortugues);
        });

        tbody.appendChild(tr);
      });
    }

    document.getElementById('searchInput').addEventListener('input', function() {
      const termo = normalizarTexto(this.value);
      if (termo === "") {
        displayTable([]);
        return;
      }

      const filtrado = entries.filter(row =>
        normalizarTexto(row['Devan.']).startsWith(termo) ||
        normalizarTexto(row['Romano translit']).startsWith(termo) ||
        normalizarTexto(row['Tradução em PT']).startsWith(termo)
      );

      const pesquisaEmPortugues = filtrado.some(row =>
        normalizarTexto(row['Tradução em PT']).startsWith(termo)
      );

      displayTable(filtrado, pesquisaEmPortugues);
    });

    // Navegação entre secções
    document.querySelectorAll('nav a').forEach(link => {
      link.addEventListener('click', () => {
        const target = link.getAttribute('data-section');
        document.querySelectorAll('section').forEach(sec => sec.classList.remove('active'));
        document.getElementById(target).classList.add('active');
      });
    });

    carregarDicionario();
  </script>
</body>
</html>

